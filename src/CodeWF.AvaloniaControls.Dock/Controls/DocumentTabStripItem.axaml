<ResourceDictionary
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:core="clr-namespace:Dock.Model.Core;assembly=Dock.Model"
    xmlns:codewf="https://codewf.com">
    <Design.PreviewWith>
        <Border Padding="20">
            <StackPanel Spacing="20">
                <DocumentTabStripItem>Leaf</DocumentTabStripItem>
                <DocumentTabStripItem IsSelected="True">Arch</DocumentTabStripItem>
                <DocumentTabStripItem Background="Yellow">Background</DocumentTabStripItem>
            </StackPanel>
        </Border>
    </Design.PreviewWith>

    <codewf:TrapezoidShapedDocumentTabStripItemPaddingConverter x:Key="TrapezoidShapedDocumentTabStripItemPaddingConverter" />
    <ContextMenu
        x:Key="DocumentTabStripItemContextMenu"
        x:CompileBindings="True"
        x:DataType="core:IDockable">
        <MenuItem
            Command="{Binding Owner.Factory.FloatDockable}"
            CommandParameter="{Binding}"
            Header="_Float"
            IsVisible="{Binding CanFloat}" />
        <MenuItem
            Command="{Binding Owner.Factory.CloseDockable}"
            CommandParameter="{Binding}"
            Header="_Close"
            IsVisible="{Binding CanClose}" />
        <MenuItem
            Command="{Binding Owner.Factory.CloseOtherDockables}"
            CommandParameter="{Binding}"
            Header="Close other tabs"
            IsVisible="{Binding CanClose}" />
        <MenuItem
            Command="{Binding Owner.Factory.CloseAllDockables}"
            CommandParameter="{Binding}"
            Header="Close all tabs"
            IsVisible="{Binding CanClose}" />
        <MenuItem
            Command="{Binding Owner.Factory.CloseLeftDockables}"
            CommandParameter="{Binding}"
            Header="_Close tabs to the left"
            IsVisible="{Binding CanClose}" />
        <MenuItem
            Command="{Binding Owner.Factory.CloseRightDockables}"
            CommandParameter="{Binding}"
            Header="_Close tabs to the right"
            IsVisible="{Binding CanClose}" />
    </ContextMenu>

    <ControlTheme x:Key="CloseInnerIconButton" TargetType="Button">
        <Setter Property="Width" Value="{DynamicResource SemiWidthIconMedium}" />
        <Setter Property="Height" Value="{DynamicResource SemiWidthIconMedium}" />
        <Setter Property="Foreground" Value="#595959" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="Template">
            <ControlTemplate TargetType="Button">
				<Border
                    Width="{TemplateBinding Width}"
                    Height="{TemplateBinding Height}"
                    CornerRadius="{TemplateBinding CornerRadius}"
                    Background="{TemplateBinding Background}">
                    <PathIcon
                        Theme="{DynamicResource InnerPathIcon}"
                        Width="{DynamicResource DocumentTabStripCloseButtonContentWidth}"
                        Height="{DynamicResource DocumentTabStripCloseButtonContentWidth}" 
                        HorizontalAlignment="Center"
						VerticalAlignment="Center"
                        Data="{TemplateBinding Content}"
                        Foreground="{TemplateBinding Foreground}" />
                </Border>
            </ControlTemplate>
        </Setter>
        <Style Selector="^:pointerover">
            <Setter Property="Foreground" Value="#FF4D4F" />
            <Setter Property="Background" Value="White" />
        </Style>
        <Style Selector="^:pressed">
            <Setter Property="Foreground" Value="{DynamicResource ButtonInputInnerPressedForeground}" />
        </Style>
    </ControlTheme>

    <ControlTheme x:Key="{x:Type DocumentTabStripItem}" TargetType="DocumentTabStripItem">

        <Setter Property="MinHeight" Value="{StaticResource DocumentTabStripItemMinHeight}" />
        <Setter Property="Padding" Value="{StaticResource DocumentTabStripItemPadding}" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="Foreground" Value="{DynamicResource DocumentTabStripItemForeground}" />
        <Setter Property="Background" Value="{DynamicResource DocumentTabStripItemBackground}" />
        <Setter Property="ContextMenu" Value="{StaticResource DocumentTabStripItemContextMenu}" />
        <Setter x:DataType="core:IDockable" Property="Template">
            <ControlTemplate>
                <Grid>
                    <codewf:TrapezoidShapedDocumentTabStripItemBorder
                        Name="PART_LayoutRoot"
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="1"
                        IsVisible="False" />
                    <DockableControl TrackingMode="Tab">
                        <Grid ColumnDefinitions="* 32"
                            HorizontalAlignment="Center"
                            Background="Transparent"
                            DockProperties.IsDragArea="True"
                            DockProperties.IsDropArea="True">
							<ContentPresenter
                                Background="#01FFFFFF"
                                Padding="{TemplateBinding Converter={StaticResource TrapezoidShapedDocumentTabStripItemPaddingConverter}}"
                                Margin="{StaticResource DocumentTabStripItemHeaderMargin}"
                                Content="{Binding}"
                                ContentTemplate="{Binding $parent[DocumentControl].HeaderTemplate}" />
                            <Button
                                Name="PART_CloseButton" Grid.Column="1"
                                Width="{DynamicResource DocumentTabStripCloseButtonWidth}"
                                Height="{DynamicResource DocumentTabStripCloseButtonWidth}"
                                Margin="{DynamicResource DocumentTabStripCloseButtonContentMargin}"
                                CornerRadius="{DynamicResource DocumentTabStripCloseButtonCorderRadius}"
                                Theme="{StaticResource CloseInnerIconButton}"
                                Content="{StaticResource SemiIconClose}"
                                Command="{Binding Owner.Factory.CloseDockable}"
                                CommandParameter="{Binding}"
                                IsVisible="False" />
                        </Grid>
                    </DockableControl>
                </Grid>

            </ControlTemplate>
        </Setter>

        <Style Selector="^:selected /template/ codewf|TrapezoidShapedDocumentTabStripItemBorder#PART_LayoutRoot">
            <Setter Property="IsVisible" Value="True" />
        </Style>
        <Style Selector="^:selected /template/ Button#PART_CloseButton">
            <Setter Property="IsVisible" Value="{ReflectionBinding CanClose}" />
        </Style>
        <Style Selector="^:not(:selected):pointerover /template/ Button#PART_CloseButton">
            <Setter Property="IsVisible" Value="{ReflectionBinding CanClose}" />
        </Style>
        <Style Selector="^:selected">
            <Setter Property="FontWeight" Value="{StaticResource DocumentTabStripItemSelectedFontWeight}" />
        </Style>
        <Style Selector="^:selected:not(:active)">
            <Setter Property="Foreground" Value="{DynamicResource DocumentTabStripItemSelectedActiveForeground}" />
            <Setter Property="Background" Value="{DynamicResource DocumentTabStripItemSelectedInactiveBackground}" />
        </Style>
        <Style Selector="^:selected:active">
            <Setter Property="Foreground" Value="{DynamicResource DocumentTabStripItemSelectedActiveForeground}" />
            <Setter Property="Background" Value="{DynamicResource DocumentTabStripItemSelectedActiveBackground}" />
        </Style>
        <Style Selector="^:not(:selected):pointerover">
            <Setter Property="Foreground" Value="{DynamicResource DocumentTabStripItemUnselectedPointeroverForeground}" />
            <Setter Property="Background" Value="{DynamicResource DocumentTabStripItemUnselectedPointeroverBackground}" />
        </Style>
    </ControlTheme>
</ResourceDictionary>